---
title: "最速降下曲線の話"
emoji: "🤖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["数学"]
published: false
---

## TL;DR

Q: なぜ最速降下曲線問題の解に角度が出てくるんですか？

A: この問題がスネルの法則の連続版だから

## はじめに

重力により坂道を摩擦なく滑る物体を考えます。始点と終点を固定した場合、始点からもっとも早く終点にたどり着く曲線はどのようなものでしょうか？

![セットアップ](/images/brachistochrone_curve/setup.png)

エネルギー保存則により、終点での速度は、始点と終点での高さの差だけに依存します。したがって、どのような経路を辿ろうとも、終点に達した時の速度は同じです。さて、始点と終点を最短距離で結ぶと直線になります(図の黒線)。しかし、この直線よりも少し「深い」曲線(図の赤線)を作ると、距離は損をしますが、直線の場合よりも先に速い速度に達するため、トータルで得をする場合があります。しかし、もっと深くして最初になるべく速度を稼ぐ経路(図の青線)では、速度が早くなる効果よりも走破すべき距離が長くなり過ぎる効果の方が大きく、到達時間が遅くなります。結局、その間にちょうど良い曲線がありそうです。その曲線を求めなさい、というのが最速効果曲線問題です。

この問題は、変分原理の例題としてよく出てきます。図のように$y$軸を下向きとする座標をとって、原点を始点とする時、求めたい曲線を

$$
y=f(x)
$$

という形に書くと、$f(x)$が満たすべき微分方程式が出てきます。その微分方程式を解くと、

$$
\begin{aligned}
x &= a (s - \sin \phi), \\
y &= a (1 - \cos \phi).
\end{aligned}
$$

という媒介変数表示を得ます。これは、半径$a$の円が$x$軸に接しながらすべらずに角度$\phi$だけ回転する時、円弧上の点が描く軌跡、すなわちサイクロイド曲線を表しています。

![サイクロイド](/images/brachistochrone_curve/cycloid.png)

多くの本では、天下り的にこの媒介変数表示を出して、「これがさっきの微分方程式を満たすでしょ」という形で解であることを確認しますが、それでは、なぜ回転角のようなものが出てくるのかが不明瞭なままです。

本稿では、この媒介変数の角度がスネルの法則の角度に由来することを説明します。

## 定式化

![折れ線近似](/images/brachistochrone_curve/linear.png)

まずは$f(x)$が満たすべき式を導出しましょう。$x$の区間を$N$等分し、一つの区間の長さを$\Delta x$とします。$i\Delta x < x \le (i+1)\Delta x$の区間を「区間$i$」と名付けましょう。それぞれの区間では曲線が直線で近似できるとする、折れ線近似を採用します。区間$i$において、曲線の$y$座標は

$$
\Delta y_i \equiv f(x_{i+1}) - f(x_i) = f'(x_i)\Delta x + O(\Delta x^2) 
$$

だけ変化します。

区間$i$での曲線の長さを\l_i$とすると、三平方の定理から

$$
\begin{aligned}
l_i &= \sqrt{\Delta x^2 + \Delta y_i^2}\\
&= \Delta x\sqrt{1 + \left(\frac{\Delta y_i}{\Delta x}\right)^2}\\
&\sim \Delta x \sqrt{1 + f'(x_i)^2}
\end{aligned}
$$

です。また、スタート地点では速度が$0$であったとすると、エネルギー保存則から常に

$$
\frac{1}{2}v^2 = gy
$$

が成り立ちます。ここから、区間$i$における速度$v_i$は

$$
v_i = \sqrt{2g f(x_i)}
$$

となります。区間$i$を走破するのにかかる時間$T_i$は

$$
T_i = \frac{l_i}{v_i} = \frac{\sqrt{1+ f'(x_i)^2}}{\sqrt{2g f(x_i)}} \Delta x
$$

です。かかる時間の総和$T$は

$$
T= \sum_i^N T_i = \sum_i^N T_i = \frac{l_i}{v_i} = \frac{\sqrt{1+ f'(x_i)^2}}{\sqrt{2g f(x_i)}} \Delta x
$$

連続極限をとると、

$$
T = \int \frac{\sqrt{1+ f'(x)^2}}{\sqrt{2g f(x)}} dx
$$

これを最小にするような$f(x)$を求めなさい、というのが最速降下曲線問題です。


## スネルの法則



## 最速降下曲線

